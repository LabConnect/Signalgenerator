\documentclass[a4paper,12pt]{article}
\usepackage{amssymb} % needed for math
\usepackage{amsmath} % needed for math
\usepackage[utf8]{inputenc} % this is needed for german umlauts
\usepackage[german]{babel} % this is needed for german umlauts
\usepackage[T1]{fontenc}    % this is needed for correct output of umlauts in pdf
\usepackage[margin=2.5cm]{geometry} %layout
\usepackage{booktabs}

\title{Kommunikationsprotokoll \\Signalgenerator <=> Computer}
\author{Hendrik Lüth, LabConnect}
\newcommand{\VID}{0x03EB}
\newcommand{\PID}{0x204F}


\begin{document}

\maketitle
\tableofcontents
\pagebreak

\section{Allgemeines}
In diesem Dokument wird die Datenübertragung zwischen dem Mikrocontroller des Signalgenerators und eines Computers definiert. Die Daten werden über den USB-Bus übertragen. Die USB-Spezifikationen\footnote{http://www.usb.org/developers/docs/usb20\_docs/usb\_20\_031815.zip} enthalten alle nötigen Informationen, welche für Kommunikationen über den Bus nötig sind.\\
Der Signalgenerator wird als HID (Human Interface Device) am Computer angemeldet, wodurch keine Installation von zusätzlichen Treibern nötig ist. Die Übertragung der Daten erfolgt über HID-Reports. Zum aktuellen Zeitpunk benutzt LabConnect für den Signalgenerator die VID \VID\ und die PID \PID, welche unter Linux als GenericHID von Atmel zu finden sind.

\section{Aufbau einer Kommunikationseinheit}
Eine Kommunikationseinheit, im folgenden als "Paket" bezeichnet, besteht aus 13 Byte. Jedes Paket hat einen 1 Byte großen Header an seinem Anfang und einen 1 Byte großen Tail an seinem Ende. Der Header enthält die Paket-ID, an welcher sich Flussrichtung der Daten und Art der Daten erkennen lassen. Ist das 5. Bit des Headers gleich 0, so ist die Flussrichtung der Daten vom Computer zum Mikrocontroller, ist es gleich 1 vom Mikrocontroller zum Computer. An den unteren 4 Bit lässt sich der Typ des Paketes erkennen.\\
In der folgenden Tabelle sind alle Befehle nach Paket-ID sortiert aufgelistet:

\begin{tabular}{|c|c|c|c|}
\hline 
Paket-ID & Flussrichtung & Bezeichnung & Größe der Daten \\ 
\hline 
0x00 & PC->\mu C & Config-Request & 1 Byte \\ 
\hline 
0x01 & PC->\mu C & Set-Command & 12 Byte \\ 
\hline 
0x02 & PC->\mu C & Data-Request & 0 Byte \\ 
\hline 
0x03 & PC->\mu C & Error/Status-Request & 0 Byte \\ 
\hline 
0x10 & \mu C->PC & Config-Response & 8 Byte \\  
\hline 
0x12 & \mu C->PC & Data-Response & 12 Byte \\ 
\hline
"0x13" & \mu C->PC & Error/Status-Response & 5 Byte \\ 
\hline
\end{tabular} 

\section{Aufbau einzelner Befehle}
\subsection{Computer => Signalgenerator}
\subsection{Signalgenerator => Computer}
\section{Berechnung der Registerwerte}
\subsection{Frequenz}
\subsection{Signalform}
\subsection{Spitzenspannung}
\subsection{Offsetspannung}
\subsection{Sonstige Register}
\section{Errorcodes}

\end{document}